# Code generated by ats/typegen from Go source. DO NOT EDIT.
# Regenerate with: make types
# Source package: async

"""async module

Generated from Go package: async

This module contains auto-generated type definitions.
All types are Python dataclasses compatible with JSON serialization.
"""

from __future__ import annotations

from dataclasses import dataclass
from typing import Any, Literal

# ErrorCode represents the classification of an error
# Documentation: https://github.com/teranos/QNTX/blob/main/docs/types/async.md#errorcode
ErrorCode = Literal["ai_error", "database_error", "file_not_found", "network_error", "parse_error", "timeout", "unknown", "validation_error"]

# JobStatus represents the current state of a job
# Documentation: https://github.com/teranos/QNTX/blob/main/docs/types/async.md#jobstatus
JobStatus = Literal["cancelled", "completed", "failed", "paused", "queued", "running"]

# ErrorContext provides structured error information for job failures
# Documentation: https://github.com/teranos/QNTX/blob/main/docs/types/async.md#errorcontext
@dataclass
class ErrorContext:
    # Where the error occurred
    stage: str
    # Error classification
    code: ErrorCode
    # Human-readable message
    message: str
    # Can the job be retried?
    retryable: bool
    # Can continue processing other items?
    recoverable: bool

# Job represents an async IX operation
# Documentation: https://github.com/teranos/QNTX/blob/main/docs/types/async.md#job
@dataclass
class Job:
    id: str
    # "data.batch-import", "bio.sequence-align"
    handler_name: str
    # For deduplication and logging
    source: str
    status: JobStatus
    progress: Progress
    cost_estimate: float
    cost_actual: float
    # Number of retry attempts (max 2)
    retry_count: int
    created_at: str
    updated_at: str
    # Handler-specific data (domain-owned)
    payload: Any | None = None
    pulse_state: PulseState | None = None
    error: str | None = None
    # For tasks grouped under parent job
    parent_job_id: str | None = None
    started_at: str | None = None
    completed_at: str | None = None

# Progress represents job progress information
# Documentation: https://github.com/teranos/QNTX/blob/main/docs/types/async.md#progress
@dataclass
class Progress:
    # Completed operations
    current: int
    # Total operations
    total: int

# PulseState represents the pulse rate limiting and budget state for a job
# Documentation: https://github.com/teranos/QNTX/blob/main/docs/types/async.md#pulsestate
@dataclass
class PulseState:
    calls_this_minute: int
    calls_remaining: int
    spend_today: float
    spend_this_month: float
    budget_remaining: float
    is_paused: bool
    # "budget_exceeded", "rate_limit", "user_requested"
    pause_reason: str | None = None

# QueueStats returns statistics about the queue
# Documentation: https://github.com/teranos/QNTX/blob/main/docs/types/async.md#queuestats
@dataclass
class QueueStats:
    queued: int
    running: int
    paused: int
    completed: int
    failed: int
    total: int

# SystemMetrics tracks resource usage for worker pool monitoring
# Documentation: https://github.com/teranos/QNTX/blob/main/docs/types/async.md#systemmetrics
@dataclass
class SystemMetrics:
    # Number of workers currently executing jobs
    workers_active: int
    # Total configured workers
    workers_total: int
    # Current memory usage in GB
    memory_used_gb: float
    # Total system memory in GB
    memory_total_gb: float
    # Memory utilization percentage
    memory_percent: float
    # Jobs waiting in queue
    jobs_queued: int
    # Jobs currently executing
    jobs_running: int

# WorkerPoolConfig contains configuration for the worker pool
# Documentation: https://github.com/teranos/QNTX/blob/main/docs/types/async.md#workerpoolconfig
@dataclass
class WorkerPoolConfig:
    # Number of concurrent workers
    workers: int
    # How often to check for new jobs
    poll_interval: int
    # Pause jobs when budget exceeded
    pause_on_budget: bool
    # Duration of each graceful start phase (default: 5min, test: 10s)
    graceful_start_phase: int

__all__ = [
    "ErrorCode",
    "ErrorContext",
    "Job",
    "JobStatus",
    "Progress",
    "PulseState",
    "QueueStats",
    "SystemMetrics",
    "WorkerPoolConfig",
]
