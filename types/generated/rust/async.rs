// Code generated by ats/typegen from Go source. DO NOT EDIT.
// Regenerate with: make types
// Source package: async
// Source last modified: 2025-12-27T13:16:16+01:00
// Source version: 85ccfb2

//! # async module
//!
//! Generated from Go package: async
//!
//! This module contains auto-generated type definitions.
//! All types include serde Serialize/Deserialize traits for JSON compatibility.

#![allow(clippy::all)]
#![allow(unused_imports)]

/// ErrorCode represents the classification of an error
#[doc = "Documentation: <https://github.com/teranos/QNTX/blob/main/docs/types/async.md#errorcode>"]
#[derive(Debug, Clone, PartialEq, Eq, serde::Serialize, serde::Deserialize)]
pub enum ErrorCode {
    #[serde(rename = "ai_error")]
    AiError,
    #[serde(rename = "database_error")]
    DatabaseError,
    #[serde(rename = "file_not_found")]
    FileNotFound,
    #[serde(rename = "network_error")]
    NetworkError,
    #[serde(rename = "parse_error")]
    ParseError,
    #[serde(rename = "timeout")]
    Timeout,
    #[serde(rename = "unknown")]
    Unknown,
    #[serde(rename = "validation_error")]
    ValidationError,
}

/// ErrorContext provides structured error information for job failures
#[doc = "Documentation: <https://github.com/teranos/QNTX/blob/main/docs/types/async.md#errorcontext>"]
#[derive(Debug, Clone, serde::Serialize, serde::Deserialize)]
pub struct ErrorContext {
    /// Where the error occurred
    pub stage: String,
    /// Error classification
    pub code: ErrorCode,
    /// Human-readable message
    pub message: String,
    /// Can the job be retried?
    pub retryable: bool,
    /// Can continue processing other items?
    pub recoverable: bool,
}

/// Job represents an async IX operation
/// ARCHITECTURE: Generic job system with handler-based execution
/// - Infrastructure (pulse/async) is domain-agnostic
/// - Domain packages provide handlers and payloads
/// - HandlerName identifies which handler executes the job
/// - Payload contains handler-specific data (domain logic controls structure)
#[doc = "Documentation: <https://github.com/teranos/QNTX/blob/main/docs/types/async.md#job>"]
#[derive(Debug, Clone, serde::Serialize, serde::Deserialize)]
pub struct Job {
    pub id: String,
    /// "data.batch-import", "bio.sequence-align"
    pub handler_name: String,
    #[serde(skip_serializing_if = "Option::is_none")]
    /// Handler-specific data (domain-owned)
    pub payload: Option<serde_json::Value>,
    /// For deduplication and logging
    pub source: String,
    pub status: JobStatus,
    pub progress: Progress,
    pub cost_estimate: f64,
    pub cost_actual: f64,
    #[serde(skip_serializing_if = "Option::is_none")]
    pub pulse_state: Option<PulseState>,
    #[serde(skip_serializing_if = "Option::is_none")]
    pub error: Option<String>,
    #[serde(skip_serializing_if = "Option::is_none")]
    /// For tasks grouped under parent job
    pub parent_job_id: Option<String>,
    /// Number of retry attempts (max 2)
    pub retry_count: i64,
    pub created_at: String,
    #[serde(skip_serializing_if = "Option::is_none")]
    pub started_at: Option<String>,
    #[serde(skip_serializing_if = "Option::is_none")]
    pub completed_at: Option<String>,
    pub updated_at: String,
}

/// JobStatus represents the current state of a job
#[doc = "Documentation: <https://github.com/teranos/QNTX/blob/main/docs/types/async.md#jobstatus>"]
#[derive(Debug, Clone, PartialEq, Eq, serde::Serialize, serde::Deserialize)]
pub enum JobStatus {
    #[serde(rename = "cancelled")]
    Cancelled,
    #[serde(rename = "completed")]
    Completed,
    #[serde(rename = "failed")]
    Failed,
    #[serde(rename = "paused")]
    Paused,
    #[serde(rename = "queued")]
    Queued,
    #[serde(rename = "running")]
    Running,
}

/// Progress represents job progress information
#[doc = "Documentation: <https://github.com/teranos/QNTX/blob/main/docs/types/async.md#progress>"]
#[derive(Debug, Clone, serde::Serialize, serde::Deserialize)]
pub struct Progress {
    /// Completed operations
    pub current: i64,
    /// Total operations
    pub total: i64,
}

/// PulseState represents the pulse rate limiting and budget state for a job
#[doc = "Documentation: <https://github.com/teranos/QNTX/blob/main/docs/types/async.md#pulsestate>"]
#[derive(Debug, Clone, serde::Serialize, serde::Deserialize)]
pub struct PulseState {
    pub calls_this_minute: i64,
    pub calls_remaining: i64,
    pub spend_today: f64,
    pub spend_this_month: f64,
    pub budget_remaining: f64,
    pub is_paused: bool,
    #[serde(skip_serializing_if = "Option::is_none")]
    /// "budget_exceeded", "rate_limit", "user_requested"
    pub pause_reason: Option<String>,
}

/// QueueStats returns statistics about the queue
#[doc = "Documentation: <https://github.com/teranos/QNTX/blob/main/docs/types/async.md#queuestats>"]
#[derive(Debug, Clone, serde::Serialize, serde::Deserialize)]
pub struct QueueStats {
    pub queued: i64,
    pub running: i64,
    pub paused: i64,
    pub completed: i64,
    pub failed: i64,
    pub total: i64,
}

/// SystemMetrics tracks resource usage for worker pool monitoring
#[doc = "Documentation: <https://github.com/teranos/QNTX/blob/main/docs/types/async.md#systemmetrics>"]
#[derive(Debug, Clone, serde::Serialize, serde::Deserialize)]
pub struct SystemMetrics {
    /// Number of workers currently executing jobs
    pub workers_active: i64,
    /// Total configured workers
    pub workers_total: i64,
    /// Current memory usage in GB
    pub memory_used_gb: f64,
    /// Total system memory in GB
    pub memory_total_gb: f64,
    /// Memory utilization percentage
    pub memory_percent: f64,
    /// Jobs waiting in queue
    pub jobs_queued: i64,
    /// Jobs currently executing
    pub jobs_running: i64,
}

/// WorkerPoolConfig contains configuration for the worker pool
#[doc = "Documentation: <https://github.com/teranos/QNTX/blob/main/docs/types/async.md#workerpoolconfig>"]
#[derive(Debug, Clone, serde::Serialize, serde::Deserialize)]
pub struct WorkerPoolConfig {
    /// Number of concurrent workers
    pub workers: i64,
    /// How often to check for new jobs
    pub poll_interval: i64,
    /// Pause jobs when budget exceeded
    pub pause_on_budget: bool,
    /// Duration of each graceful start phase (default: 5min, test: 10s)
    pub graceful_start_phase: i64,
}
