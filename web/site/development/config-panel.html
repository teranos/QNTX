<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QNTX - config-panel</title>
  <link rel="icon" type="image/jpeg" href="../qntx.jpg">
  <link rel="stylesheet" href="../css/core.css">
  <link rel="stylesheet" href="../css/docs.css">
</head>
<body>
<nav class="doc-nav">
  <a href="../index.html">
    <img src="../qntx.jpg" alt="QNTX" class="site-logo">Documentation Home
  </a>
</nav>
<h1>Config Panel UI Design Specification</h1>
<blockquote>
<p><strong>Architecture Reference</strong>: For backend config system architecture, see <a href="../architecture/config-system.html"><code>docs/architecture/config-system.md</code></a></p>
</blockquote>
<h2>Purpose</h2>
<p>This document specifies the UI/UX design for the QNTX configuration panel. It defines the visual layout, interaction model, and future product vision for how users interact with configuration in the web UI.</p>
<h2>Current Issues</h2>
<ol>
<li><strong>Size Constraint</strong>: Panel is cramped at max-height: 500px</li>
<li><strong>Layout Problem</strong>: Overlays content, competes for space with ATS editor</li>
<li><strong>Poor Readability</strong>: Long config values (API keys, tokens) are truncated</li>
<li><strong>No Visual Hierarchy</strong>: Flat list doesn't show config precedence clearly</li>
<li><strong>Mixed Concerns</strong>: Shows everything together, hard to distinguish editable vs read-only</li>
</ol>
<h2>Design Goals</h2>
<h3>Layout</h3>
<ul>
<li><strong>Full-screen left half</strong>: Config panel takes 50% of screen width when shown</li>
<li><strong>Hide ATS editor</strong>: When config panel is open, hide the left panel entirely</li>
<li><strong>Dedicated space</strong>: No competition for vertical space, full scrollable area</li>
</ul>
<h3>Information Architecture</h3>
<p><strong>Group by source</strong>: Collapsible sections for each config source (see <a href="../architecture/config-system.html">config-system.md</a> for precedence details):</p>
<ul>
<li>System Config (<code>/etc/qntx/config.toml</code>)</li>
<li>User Config (<code>~/.qntx/config.toml</code>)</li>
<li>UI Config (<code>~/.qntx/config_from_ui.toml</code>) - <strong>Editable</strong></li>
<li>Project Config (<code>project/config.toml</code>)</li>
<li>Environment Variables (<code>QNTX_*</code>)</li>
</ul>
<p><strong>Visual precedence</strong>: Make it clear which value is effective</p>
<ul>
<li>Highlight active value</li>
<li>Show overridden values in gray/dimmed</li>
<li>Indicate "This setting is overridden by [source]"</li>
</ul>
<h3>Interaction Model</h3>
<ul>
<li><strong>Read-only by default</strong>: Most config shown as information</li>
<li><strong>Editable UI config</strong>: Only UI config section allows editing</li>
<li><strong>Inline editing</strong>: Click to edit UI config values</li>
<li><strong>Save feedback</strong>: Clear indication when changes are saved to <code>~/.qntx/config_from_ui.toml</code></li>
</ul>
<h3>Visual Design</h3>
<ul>
<li><strong>Better typography</strong>: Use code font for config values</li>
<li><strong>Truncation with expand</strong>: Long values truncated with "..." and click to expand</li>
<li><strong>Search/filter</strong>: Retain existing search, but with better visual feedback</li>
<li><strong>Source badges</strong>: Color-coded badges showing source (system/user/user_ui/project/env)</li>
</ul>
<h2>Technical Implementation</h2>
<h3>Files to Modify</h3>
<ol>
<li>
<p><strong><code>web/ts/config-panel.js</code></strong></p>
<ul>
<li>Change from overlay to full-screen toggle</li>
<li>Add source grouping logic</li>
<li>Implement inline editing for UI config</li>
<li>Add expand/collapse for sections</li>
</ul>
</li>
<li>
<p><strong><code>web/css/config-panel.css</code></strong></p>
<ul>
<li>New layout: <code>position: fixed; left: 0; width: 50%; height: 100%;</code></li>
<li>Styles for source groups</li>
<li>Visual hierarchy for precedence</li>
<li>Source badge styles</li>
</ul>
</li>
<li>
<p><strong><code>web/index.html</code></strong> (if needed)</p>
<ul>
<li>May need template changes for new structure</li>
</ul>
</li>
</ol>
<h3>Data Flow</h3>
<pre><code class="language-javascript">// Current:
GET /api/config?introspection=true
â†’ Flat list of settings with sources

// Enhanced (future):
GET /api/config?introspection=true
â†’ Grouped by source
â†’ Each setting knows: key, value, source, is_effective, overridden_by
</code></pre>
<h3>Backend Support</h3>
<p>Backend implementation is documented in <a href="../architecture/config-system.html"><code>docs/architecture/config-system.md</code></a>.</p>
<p>Current backend capabilities:</p>
<ul>
<li>âœ… Config precedence includes <code>config_from_ui.toml</code></li>
<li>âœ… Introspection tracks granular sources (system/user/user_ui/project/env)</li>
<li>âœ… Clean TOML marshaling for updates</li>
<li>âœ… POST /api/config with updates writes to UI config only</li>
</ul>
<h2>UI Mockup (Text-Based)</h2>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â‰¡ Configuration            [âœ• Close]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ” [Filter settings...]             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ â–¼ System Config                     â”‚
â”‚   (Read-only, /etc/qntx/config.toml)â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ database.path               â”‚   â”‚
â”‚   â”‚ /var/lib/qntx/qntx.db       â”‚   â”‚
â”‚   â”‚ [system]                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚ â–¼ User Config                       â”‚
â”‚   (Read-only, ~/.qntx/config.toml)  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ openrouter.api_key          â”‚   â”‚
â”‚   â”‚ sk-or-v1-9bee...            â”‚   â”‚
â”‚   â”‚ [user] âš  Overridden by env  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚ â–¼ UI Config (Editable)              â”‚
â”‚   (Managed by UI, ~/.qntx/config... â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ local_inference.enabled     â”‚   â”‚
â”‚   â”‚ [âœ“] true            [Edit]  â”‚   â”‚
â”‚   â”‚ [user_ui] âœ… Active         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ local_inference.model       â”‚   â”‚
â”‚   â”‚ mistral          [â–¼ Edit]   â”‚   â”‚
â”‚   â”‚ [user_ui] âœ… Active         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚ â–¼ Project Config                    â”‚
â”‚   (Read-only, project/config.toml)  â”‚
â”‚   (No settings - project config     â”‚
â”‚    would override UI settings)      â”‚
â”‚                                     â”‚
â”‚ â–¼ Environment Variables             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ openrouter.api_key          â”‚   â”‚
â”‚   â”‚ sk-or-v1-bb5b...            â”‚   â”‚
â”‚   â”‚ [environment] âœ… Active     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2>Behavior Specifications</h2>
<h3>Opening Config Panel</h3>
<ol>
<li>Click â‰¡ in symbol palette</li>
<li>Left panel (#left-panel) fades out and hides</li>
<li>Config panel slides in from left, taking 50% width</li>
<li>ATS editor completely hidden (no competing for space)</li>
</ol>
<h3>Closing Config Panel</h3>
<ol>
<li>Click âœ• or click outside panel</li>
<li>Config panel slides out to left</li>
<li>Left panel fades back in</li>
<li>ATS editor visible again</li>
</ol>
<h3>Editing UI Config Values</h3>
<ol>
<li>Only UI Config section allows editing</li>
<li>Click [Edit] button or value to enter edit mode</li>
<li>For booleans: toggle switch</li>
<li>For strings: inline text input</li>
<li>For enums (like model): dropdown</li>
<li>Changes auto-save to <code>~/.qntx/config_from_ui.toml</code></li>
<li>Show toast: "Saved to UI config"</li>
</ol>
<h3>Source Precedence Display</h3>
<ul>
<li><strong>Effective value</strong>: Green checkmark, normal weight</li>
<li><strong>Overridden value</strong>: Gray text, strike-through</li>
<li><strong>Override indicator</strong>: "âš  Overridden by [source]" in orange</li>
</ul>
<h2>Implementation Phases</h2>
<h3>Phase 1: Layout Restructure âœ… (Completed)</h3>
<ul>
<li>Change panel to full-screen left half</li>
<li>Implement show/hide toggle with left panel</li>
<li>Basic scrolling and close button</li>
</ul>
<h3>Phase 2: Source Grouping âœ… (Completed)</h3>
<ul>
<li>Group settings by source</li>
<li>Collapsible sections</li>
<li>Source badges</li>
</ul>
<h3>Phase 3: Precedence Visualization (In Progress)</h3>
<ul>
<li>Highlight active values</li>
<li>Show overridden state</li>
<li>Precedence indicators</li>
<li><strong>Requires</strong>: Backend to provide <code>is_effective</code> and <code>overridden_by</code> fields</li>
</ul>
<h3>Phase 4: Inline Editing (Planned)</h3>
<ul>
<li>Edit UI config values inline</li>
<li>Type-appropriate inputs (toggle, text, dropdown)</li>
<li>Auto-save with feedback</li>
<li><strong>Requires</strong>: Edit modal or inline form implementation</li>
</ul>
<h3>Phase 5: Polish âœ… (Completed)</h3>
<ul>
<li>Smooth animations</li>
<li>Better typography</li>
<li>Search improvements</li>
<li>Responsive design</li>
</ul>
<h2>Future Enhancements</h2>
<p>For discussion of potential future enhancements including multi-provider configuration support, see Issue #205.</p>
<h3>Current Design Principles</h3>
<p>The config panel's current job is to <strong>visualize the dataflow</strong> from our 5 configuration sources:</p>
<ol>
<li><strong>Show final merged state</strong> (what server sees)</li>
<li><strong>Attribute each value to its provider</strong> (source visibility)</li>
<li><strong>Indicate override relationships</strong> (precedence chain)</li>
</ol>
<p><strong>Current implementation shows:</strong></p>
<pre><code>openrouter.api_key = sk-***           [ENV] âœ“
  âš  overrides [USER]

database.path = /var/lib/qntx/...     [PROJECT] âœ“
  âš  overrides [SYSTEM]

pulse.daily_budget_usd = 10.0         [USER_UI] âœ“
  (no overrides)
</code></pre>
<h3>Config Dataflow Visualization (Current)</h3>
<ul>
<li><strong>Precedence chain view</strong> - Show all sources for a key, with precedence order</li>
<li><strong>Config diff view</strong> - Compare effective config against specific source</li>
<li><strong>Config timeline</strong> - Show when values changed and which provider updated them</li>
<li><strong>Config dependencies</strong> - Visualize which settings depend on each other</li>
</ul>
<h3>Enhanced UX Features (Future)</h3>
<ul>
<li><strong>Inline editing</strong>: Edit UI config values with type-appropriate inputs</li>
<li><strong>Value expansion</strong>: Click to expand long API keys/secrets</li>
<li><strong>Config validation</strong>: Show warnings for invalid values</li>
<li><strong>Reset to defaults</strong>: Button to clear UI config overrides</li>
<li><strong>Export config</strong>: Download merged config with or without secrets</li>
<li><strong>Documentation drawer</strong>: Click config key to open documentation panel on right side</li>
</ul>
<h3>Documentation Integration (See Issue #207)</h3>
<p><strong>Concept</strong>: Config panel with integrated documentation viewer</p>
<p><strong>Interaction Flow</strong>:</p>
<ol>
<li>User clicks config key (e.g., <code>openrouter.model</code>)</li>
<li>Right side slides in with documentation for that specific config option</li>
<li>Documentation drawer shows:
<ul>
<li><strong>Description</strong>: What this config controls</li>
<li><strong>Type</strong>: String, number, boolean, enum</li>
<li><strong>Valid values</strong>: Enumeration or constraints</li>
<li><strong>Default value</strong>: What happens if unset</li>
<li><strong>Examples</strong>: Common use cases with sample values</li>
<li><strong>Related settings</strong>: Other config that interacts with this one</li>
<li><strong>Source information</strong>: Which configuration source provided this value</li>
</ul>
</li>
</ol>
<p><strong>Example Documentation Entry</strong>:</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ openrouter.model                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚ Description:                                                â”‚
â”‚   Specifies which AI model to use for OpenRouter           â”‚
â”‚   inference calls. Affects cost, speed, and quality.       â”‚
â”‚                                                             â”‚
â”‚ Type: string                                                â”‚
â”‚                                                             â”‚
â”‚ Valid Values:                                               â”‚
â”‚   â€¢ anthropic/claude-haiku-4    (fast, cheap)              â”‚
â”‚   â€¢ anthropic/claude-3.5-sonnet:beta (balanced)            â”‚
â”‚   â€¢ x-ai/grok-code-fast-1       (code-focused)             â”‚
â”‚   â€¢ meta-llama/llama-3.2-3b-instruct (very fast)           â”‚
â”‚                                                             â”‚
â”‚ Default: anthropic/claude-haiku-4.5                         â”‚
â”‚                                                             â”‚
â”‚ Examples:                                                   â”‚
â”‚   For code generation:  x-ai/grok-code-fast-1              â”‚
â”‚   For reasoning tasks:  anthropic/claude-3.5-sonnet:beta   â”‚
â”‚   For bulk operations:  meta-llama/llama-3.2-3b-instruct   â”‚
â”‚                                                             â”‚
â”‚ Related Settings:                                           â”‚
â”‚   â€¢ openrouter.api_key - Required for OpenRouter access    â”‚
â”‚   â€¢ local_inference.enabled - Alternative to cloud         â”‚
â”‚                                                             â”‚
â”‚ Cost Impact: Varies by model (see OpenRouter pricing)      â”‚
â”‚                                                             â”‚
â”‚ [View OpenRouter Models â†’]                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Implementation Considerations</strong>:</p>
<ul>
<li>Documentation stored in structured format (TOML/YAML/Markdown with frontmatter)</li>
<li>Backend serves documentation via <code>/api/config/docs/:key</code> endpoint</li>
<li>Frontend caches docs for instant display</li>
<li>Fallback to generated docs from schema if manual docs missing</li>
<li>Support for markdown rendering in description field</li>
<li>Link out to external docs (OpenRouter pricing, etc.)</li>
</ul>
<p><strong>Symbol Integration</strong>:</p>
<ul>
<li><strong>â–£</strong> - Documentation symbol</li>
<li>Clicking config key directly opens its documentation in right panel</li>
<li>â–£ in symbol palette opens documentation browser (all available docs)</li>
<li>Visual indicator (subtle) shows which settings have documentation available</li>
</ul>
<h2>Related Documentation</h2>
<ul>
<li><strong>Backend Architecture</strong>: <a href="../architecture/config-system.html"><code>docs/architecture/config-system.md</code></a> - Config loading, persistence, source tracking</li>
<li><strong>User Guide</strong>: How to configure QNTX (TBD)</li>
<li><strong>API</strong>: <code>internal/config/config.go</code> (implementation)</li>
</ul>
<footer class="site-footer">
  <p class="provenance">Generated by sitegen.nix at commit <a href="https://github.com/teranos/QNTX/commit/b664e41fac56a47a886ef727bc4342996b929f1d-dirty">b664e41-dirty</a></p>
</footer>
</body>
</html>
